define("scalejs.routing-historyjs/history",["scalejs!core","history","scalejs.reactive"],function(t,e){function r(t){return e.pushState(t.data,t.title,t.url)}function a(){return e.getState()}function n(t){return e.replaceState(t.data,t.title,t.url)}function s(){var r=t.reactive.Observable,n=t.reactive.Disposable;return r.createWithDisposable(function(t){e.Adapter.bind(window,"statechange",function(){t.onNext(a())});return n.create(function(){window.onstatechange=null})}).publishValue(a()).refCount()}return{add:r,get:a,replace:n,observe:s}}),define("scalejs.routing-historyjs/routing",["scalejs!core","./history","scalejs.statechart-scion","scalejs.reactive"],function(t,e){function r(){return e.observe().select(i)}function a(t){return"/"===t||"?"===t||""===t}function n(t){var e="?"+t.path.join("/");return f(t.parameters)&&(e+="?"+Object.keys(t.parameters).map(function(e){return e+"="+t.parameters[e]}).join("&")),e}function s(t){var e=t.replace("/?",""),r=a(e)?[[""]]:e.split("?").filter(function(t){return""!==t}).map(function(t,e){return 0===e?t.split("/"):t.split("&")});return{path:r[0],parameters:f(r[1])?r[1].reduce(function(t,e){var r=e.split("=");return t[r[0]]=r[1],t},{}):void 0}}function i(t){var e=t.hash.replace(p,""),r=s(e);return b(r,{url:n(r),timestamp:(new Date).getTime()})}function u(t){return h(t,"string")?t.replace("{","").replace("}",""):t}function o(t){var e=s(t);return E(function(t){var r;O[t.id]=e,r=v("routed",function(t){return t.data.path[0]===e.path[0]?(e.path.slice(1).forEach(function(e,r){t.data[u(e)]=t.data.path[r+1]}),t.data=b(t.data,t.data.parameters),!0):!1},m(t.id)),d?D(d,r):k.push(r)})}function c(t){x?(x=!1,e.replace({url:n(t)})):e.add({url:n(t)})}function l(e,a){function n(){function t(t){return t===e}var e;o.add(S().subscribe(function(t){var e;f(O,t.state)&&"entry"===t.event&&(e=O[t.state],e.path=e.path.map(function(e){var r=e.match(/[^{}]+(?=\})/);return f(r)?t.currentEvent.data[r[0]]:e}),f(e.parameters)&&Object.keys(e.parameters).forEach(function(r){e.parameters[r]=t.currentEvent.data[u(e.parameters[r])]}),c(e))})),o.add(r().subscribe(function(r){t(r.url)||(e=r.url,w("routed",{path:r.path,parameters:r.parameters},0))}))}var s,i,o=new t.reactive.CompositeDisposable;return d=e,f(a,"baseUrl")?(p=a.baseUrl,i=g(arguments).slice(2,arguments.length)):i=g(arguments).slice(1,arguments.length),s=y.apply(null,[e,v("router.disposing",m("router.disposed")),y("router.waiting",j(n)),y("router.disposed",j(function(){o.dispose(),O={},k=[]}))].concat(k).concat(i))}var p,d,f=t.object.has,h=t.type.is,b=t.object.merge,g=t.array.toArray,v=t.state.builder.on,m=t.state.builder.gotoInternally,j=t.state.builder.onEntry,y=t.state.builder.state,w=t.state.raise,E=t.functional.builder.$yield,D=t.state.registerTransition,S=t.state.observe,O={},k=[],x=!0;return{route:o,routerState:l}}),define("scalejs.routing-historyjs",["scalejs!core","./scalejs.routing-historyjs/routing"],function(t,e){t.registerExtension({routing:e})});